import os.path
import random
import sys
sys.path.insert(0, '../')
import matplotlib.pyplot as plt
import numpy as np
from IPython.display import Markdown, display

# Datasets
from aif360.datasets import MEPSDataset19, AdultDataset, GermanDataset, BankDataset, CompasDataset
from aif360.datasets.compas_dataset1 import CompasDataset_1
# from aif360.datasets import MEPSDataset20
# from aif360.datasets import MEPSDataset21

# Fairness metrics
from aif360.metrics import BinaryLabelDatasetMetric
from aif360.metrics import ClassificationMetric

# Explainers
from aif360.explainers import MetricTextExplainer

# Scalers
from sklearn.preprocessing import StandardScaler

# Classifiers
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.pipeline import make_pipeline

# Bias mitigation techniques
from aif360.algorithms.preprocessing import Reweighing
from aif360.algorithms.inprocessing import PrejudiceRemover\

from model_training.model import Model
from model_training.network import *
from model_training.layer import *
from tensorflow import keras
from tensorflow.keras import layers

import tensorflow as tf
import numpy as np
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import InputLayer, Flatten, Dense, Dropout, LeakyReLU, BatchNormalization
# import torch
from sklearn.metrics import accuracy_score
from collections import defaultdict

from aif360.metrics.metric_test import metric_test1, get_metrics, describe_metrics, initial_dnn, describe, \
    metric_test_new_inputs, describe_metrics_new_inputs, metric_test_multivariate, metric_test_causal
from plot_result import Plot

processing_names = ["RW", "OP", "DI", "META", "AD", "PR", "GR", "CEO", "EO", "RO"]

dataset_name = ["Adult income", "German credit", "COMPAS"]
sens_attrs = [["race", "sex"], ["sex", "age"], ["sex", "race"]]
all_uni_orig_metrics = [[[{'disp_imp': [0.584176974233109], 'stat_par_diff': [-0.1026330731582483], 'acc': [0.8356305741873664], 'group': [0.086], 'causal': [0.06986027944111776]},
                         {'disp_imp': [0.3499775857715558], 'stat_par_diff': [-0.19114555570445152], 'acc': [0.8356305741873664], 'group': [0.134], 'causal': [0.059880239520958084]}],
                        [{'disp_imp': [0.362920548355989], 'stat_par_diff': [-0.10454975011865361], 'group': [0.126], 'causal': [0.0658682634730539], 'acc': [0.8016788370982052]},
                         {'disp_imp': [0.0], 'stat_par_diff': [-0.22355105795768168], 'group': [0.21], 'causal': [0.17764471057884232], 'acc': [0.8016788370982052]}],
                        [{'disp_imp': [0.5806862455744509], 'stat_par_diff': [-0.08993312125096391], 'group': [0.05199999999999999], 'acc': [0.8457431685357764]},
                         {'disp_imp': [0.31700067711336477], 'stat_par_diff': [-0.17545200852534631], 'group': [0.116], 'acc': [0.8448270415416206]}],
                        [{'disp_imp': [0.5350309096261406], 'stat_par_diff': [-0.10105242954480025], 'acc': [0.8495614358369573, 0.8495614358369573], 'group': [0.11000000000000001], 'causal': [0.017964071856287425]},
                         {'disp_imp': [0.26219575992624666], 'stat_par_diff': [-0.19669418759895374], 'acc': [0.8495614358369573, 0.8495614358369573], 'group': [0.16399999999999998], 'causal': [0.0718562874251497]}],
                        [{'disp_imp': [0.5350309096261406], 'stat_par_diff': [-0.10105242954480025], 'acc': [0.8495614358369573, 0.8495614358369573], 'group': [0.11000000000000001], 'causal': [0.017964071856287425]},
                         {'disp_imp': [0.26219575992624666], 'stat_par_diff': [-0.19669418759895374], 'acc': [0.8495614358369573, 0.8495614358369573], 'group': [0.16399999999999998], 'causal': [0.0718562874251497]}],
                        [{'disp_imp': [0.5350309096261406], 'stat_par_diff': [-0.10105242954480025], 'acc': [0.8495614358369573, 0.8495614358369573], 'group': [0.10800000000000001], 'causal': [0.017964071856287425]},
                         {'disp_imp': [0.26219575992624666], 'stat_par_diff': [-0.19669418759895374], 'acc': [0.8495614358369573, 0.8495614358369573], 'group': [0.16399999999999998], 'causal': [0.0718562874251497]}],
                        [{'disp_imp': [0.5869088573918627], 'stat_par_diff': [-0.08402455668937868], 'acc': [0.8480872705830323, 0.8480872705830323], 'group': [0.10400000000000001], 'causal': [0.007984031936127744]},
                         {'disp_imp': [0.2615807494641273], 'stat_par_diff': [-0.18575167632008655],'acc': [0.8480872705830323, 0.8480872705830323], 'group': [0.12400000000000001],'causal': [0.021956087824351298]}],
                        [{'disp_imp': [0.5869088573918627], 'stat_par_diff': [-0.08402455668937868], 'acc': [0.8480872705830323, 0.8480872705830323], 'group': [0.08399999999999999], 'causal': [0.013972055888223553]},
                         {'disp_imp': [0.2615807494641273], 'stat_par_diff': [-0.18575167632008655],'acc': [0.8480872705830323, 0.8480872705830323], 'group': [0.196],'causal': [0.033932135728542916]}],
                        [{'disp_imp': [0.5499430640479012], 'stat_par_diff': [-0.10404084428947677], 'acc': [0.8491928945234761, 0.8491928945234761], 'group': [0.094], 'causal': [0.003992015968063872]},
                         {'disp_imp': [0.25831705477656997], 'stat_par_diff': [-0.21120504968056045], 'acc': [0.8491928945234761, 0.8491928945234761], 'group': [0.22799999999999998], 'causal': [0.021956087824351298]}],
                        [{'disp_imp': [0.5499430640479012], 'stat_par_diff': [-0.10404084428947677], 'acc': [0.8492666027861723, 0.8492666027861723], 'group': [0.094], 'causal': [0.003992015968063872]},
                         {'disp_imp': [0.25832895742502726], 'stat_par_diff': [-0.21114384340118025], 'acc': [0.8492666027861723, 0.8492666027861723], 'group': [0.22799999999999998], 'causal': [0.021956087824351298]}]],
                        
                        [[{'disp_imp': [2.2670579603815115], 'stat_par_diff': [0.17837223714108658], 'acc': [0.8033333333333333], 'group': [0.07599999999999998], 'causal': [0.03992015968063872]},
                         {'disp_imp': [2.5754716981132075], 'stat_par_diff': [0.2423802612481858],'acc': [0.8033333333333333], 'group': [0.16799999999999998],'causal': [0.029940119760479042]}],
                        [{'disp_imp': ["inf"], 'stat_par_diff': [0.14893617021276595], 'group': [0.116], 'causal': [0.08582834331337326], 'acc': [0.74]},
                         {'disp_imp': ["inf"], 'stat_par_diff': [0.2641509433962264], 'group': [0.128],'causal': [0.08782435129740519], 'acc': [0.74]}],
                        [{'disp_imp': [1.2623891497130932], 'stat_par_diff': [0.07698194061830421], 'group': [0.04200000000000004], 'acc': [0.7085714285714285]},
                         {'disp_imp': [1.1428756532630762], 'stat_par_diff': [0.0428880735372289],'group': [0.10799999999999998], 'acc': [0.7114285714285714]}],
                        [{'disp_imp': [1.492077863286555], 'stat_par_diff': [0.11227019210906836], 'acc': [0.7766666666666666, 0.7766666666666666], 'group': [0.17999999999999994], 'causal': [0.10179640718562874]},
                         {'disp_imp': [2.419811320754717], 'stat_par_diff': [0.29890764647467727], 'acc': [0.7766666666666666, 0.7766666666666666], 'group': [0.19599999999999995], 'causal': [0.09780439121756487]}],
                        [{'disp_imp': [1.492077863286555], 'stat_par_diff': [0.11227019210906836], 'acc': [0.7766666666666666, 0.7766666666666666], 'group': [0.18008971011581976], 'causal': [0.0962962962962963]},
                         {'disp_imp': [2.419811320754717], 'stat_par_diff': [0.29890764647467727], 'acc': [0.7766666666666666, 0.7766666666666666], 'group': [0.1872295227310633], 'causal': [0.14285714285714285]}],
                        [{'disp_imp': [1.492077863286555], 'stat_par_diff': [0.11227019210906836], 'acc': [0.7766666666666666, 0.7766666666666666], 'group': [0.17799999999999994], 'causal': [0.0998003992015968]},
                         {'disp_imp': [2.419811320754717], 'stat_par_diff': [0.29890764647467727], 'acc': [0.7766666666666666, 0.7766666666666666], 'group': [0.19399999999999995], 'causal': [0.09580838323353294]}],
                        [{'disp_imp': [1.492077863286555], 'stat_par_diff': [0.11227019210906836], 'acc': [0.7766666666666666, 0.7766666666666666], 'group': [0.17999999999999994], 'causal': [0.10179640718562874]},
                         {'disp_imp': [2.419811320754717], 'stat_par_diff': [0.29890764647467727], 'acc': [0.7766666666666666, 0.7766666666666666], 'group': [0.19599999999999995], 'causal': [0.09780439121756487]}],
                        [{'disp_imp': [1.3456513624486748], 'stat_par_diff': [0.0956413964057013], 'acc': [0.76, 0.76], 'group': [0.09829530553370047], 'causal': [0.0196078431372549]},
                         {'disp_imp': [2.1452530697813716], 'stat_par_diff': [0.2921090825758154], 'acc': [0.76, 0.76], 'group': [0.2823639774859287], 'causal': [0.05813953488372093]}],
                        [{'disp_imp': [1.325023084025854], 'stat_par_diff': [0.09037227214377402], 'acc': [0.7566666666666667, 0.7566666666666667], 'group': [0.09292866082603252], 'causal': [0.0196078431372549]},
                         {'disp_imp': [2.1452530697813716], 'stat_par_diff': [0.2921090825758154], 'acc': [0.7566666666666667, 0.7566666666666667], 'group': [0.2823639774859287], 'causal': [0.05813953488372093]}],
                        [{'disp_imp': [1.3456513624486748], 'stat_par_diff': [0.0956413964057013], 'acc': [0.76, 0.76], 'group': [0.09829530553370047], 'causal': [0.0196078431372549]},
                         {'disp_imp': [2.1452530697813716], 'stat_par_diff': [0.2921090825758154], 'acc': [0.76, 0.76],'group': [0.2823639774859287], 'causal': [0.05813953488372093]}]],
                        
                        [[{'disp_imp': [0.7881016474641972], 'stat_par_diff': [-0.14297442603894217], 'acc': [0.9789416846652268], 'group': [0.04999999999999999], 'causal': [0.003992015968063872]},
                         {'disp_imp': [0.8670964243756966], 'stat_par_diff': [-0.08180368598657617],'acc': [0.9789416846652268], 'group': [0.14800000000000002],'causal': [0.007984031936127744]}],
                        [{'disp_imp': [0.7246763808878346], 'stat_par_diff': [-0.22006500541711815], 'group': [0.222], 'causal': [0.14171656686626746], 'acc': [0.6647727272727273]},
                         {'disp_imp': [0.6803250225710119], 'stat_par_diff': [-0.24481438144878198],'group': [0.21000000000000002], 'causal': [0.06387225548902195], 'acc': [0.6647727272727273]}],
                        [{'disp_imp': [0.804703684146391], 'stat_par_diff': [-0.1242794737250239], 'group': [0.15799999999999997], 'acc': [0.9856481481481482]},
                         {'disp_imp': [0.8223544536013305], 'stat_par_diff': [-0.10751293589658956],'group': [0.10199999999999998], 'acc': [0.9863425925925926]}],
                        [{'disp_imp': [1.3944015444015445], 'stat_par_diff': [0.1335876198779425], 'acc': [0.9838012958963283, 0.9838012958963283], 'group': [0.043999999999999984], 'causal': [0.0]},
                         {'disp_imp': [1.2210648543424063], 'stat_par_diff': [0.08572646991825988],'acc': [0.9838012958963283, 0.9838012958963283], 'group': [0.128], 'causal': [0.0]}],
                        [{'disp_imp': [1.3904118404118406], 'stat_par_diff': [0.13223626852659115], 'acc': [0.9838012958963283, 0.9838012958963283], 'group': [0.03799999999999998], 'causal': [0.007984031936127744]},
                         {'disp_imp': [1.2169256514463305], 'stat_par_diff': [0.08412133348166279],'acc': [0.9838012958963283, 0.9838012958963283], 'group': [0.134],'causal': [0.001996007984031936]}],
                        [{'disp_imp': [1.3904118404118406], 'stat_par_diff': [0.13223626852659115], 'acc': [0.9838012958963283, 0.9838012958963283], 'group': [0.035999999999999976], 'causal': [0.007984031936127744]},
                         {'disp_imp': [1.2169256514463305], 'stat_par_diff': [0.08412133348166279],'acc': [0.9838012958963283, 0.9838012958963283], 'group': [0.132],'causal': [0.001996007984031936]}],
                        [{'disp_imp': [0.8000329597890573], 'stat_par_diff': [-0.1322362685265911], 'acc': [0.9838012958963283, 0.9838012958963283], 'group': [0.03799999999999998], 'causal': [0.007984031936127744]},
                         {'disp_imp': [0.8625942639086586], 'stat_par_diff': [-0.08412133348166284],'acc': [0.9838012958963283, 0.9838012958963283], 'group': [0.134],'causal': [0.001996007984031936]}],
                        [{'disp_imp': [0.8071852340145024], 'stat_par_diff': [-0.12750653879686136], 'acc': [0.9800215982721382, 0.9800215982721382], 'group': [0.0], 'causal': [0.017964071856287425]},
                         {'disp_imp': [0.8608767306718398], 'stat_par_diff': [-0.08586155565797349],'acc': [0.9800215982721382, 0.9800215982721382], 'group': [0.10199999999999998],'causal': [0.003992015968063872]}],
                        [{'disp_imp': [0.809902318090118], 'stat_par_diff': [-0.12537273391375592], 'acc': [0.9800215982721382, 0.9800215982721382], 'group': [0.0], 'causal': [0.017964071856287425]},
                         {'disp_imp': [0.8621771486940025], 'stat_par_diff': [-0.085058987439675],'acc': [0.9800215982721382, 0.9800215982721382], 'group': [0.09999999999999998],'causal': [0.003992015968063872]}],
                        [{'disp_imp': [0.8071852340145024], 'stat_par_diff': [-0.12750653879686136], 'acc': [0.9800215982721382, 0.9800215982721382], 'group': [0.0], 'causal': [0.017964071856287425]},
                         {'disp_imp': [0.8608767306718398], 'stat_par_diff': [-0.08586155565797349],'acc': [0.9800215982721382, 0.9800215982721382], 'group': [0.10199999999999998],'causal': [0.003992015968063872]}]]
                        ]

all_uni_trans_metrics = [[[{'disp_imp': [0.6869002147058121], 'stat_par_diff': [-0.0815049991291954], 'acc': [0.831650328001769], 'group': [0.062], 'causal': [0.09580838323353294]},
                          {'disp_imp': [0.43671438273349666], 'stat_par_diff': [-0.17091958130462617], 'acc': [0.827817498341564], 'group': [0.11000000000000001], 'causal': [0.1277445109780439]}],
                         [{'disp_imp': [0.38612949523383466], 'stat_par_diff': [-0.09468577748322285], 'acc': [0.8023612912031666], 'group': [0.08600000000000001], 'causal': [0.031936127744510975]},
                          {'disp_imp': [0.0], 'stat_par_diff': [-0.2131248083409997], 'acc': [0.802088309561182], 'group': [0.174], 'causal': [0.14770459081836326]}],
                         [{'disp_imp': [0.5776922288802987], 'stat_par_diff': [-0.10205009760107189], 'group': [0.052000000000000005], 'acc': [0.8457431685357764]},
                          {'disp_imp': [0.3164054804281286], 'stat_par_diff': [-0.1998406234154937], 'group': [0.13], 'acc': [0.8448270415416206]}],
                         [{'disp_imp': [0.7000536179618609], 'stat_par_diff': [-0.1704990954295199], 'acc': [0.6762733102380777], 'group': [0.14999999999999997], 'causal': [0.021956087824351298]},
                          {'disp_imp': [0.9356373313973183], 'stat_par_diff': [-0.04239868872311803], 'acc': [0.5749244490307364], 'group': [0.08599999999999997], 'causal': [0.2954091816367265]}],
                         [{'disp_imp': [0.9489329192183816], 'stat_par_diff': [-0.012042383303299459], 'acc': [0.8458023144394486], 'group': [0.04200000000000001], 'causal': [0.10978043912175649]},
                          {'disp_imp': [0.4704536173609729], 'stat_par_diff': [-0.1140472645334842], 'acc': [0.8486769366846023], 'group': [0.013999999999999999], 'causal': [0.05588822355289421]}],
                         [{'disp_imp': [0.46164935123128426], 'stat_par_diff': [-0.11209467600737874], 'acc': [0.8403479029999263], 'group': [0.074], 'causal': [0.03792415169660679]},
                          {'disp_imp': [0.20666829821844288], 'stat_par_diff': [-0.0323385347647196], 'acc': [0.7798334193263065], 'group': [0.0], 'causal': [0.023952095808383235]}],
                         [{'disp_imp': [0.8780046863567744], 'stat_par_diff': [-0.023409004474869294], 'acc': [0.8396108203729639], 'group': [0.05200000000000002], 'causal': [0.04590818363273453]},
                          {'disp_imp': [0.5424947954051059], 'stat_par_diff': [-0.0990804186953738],'acc': [0.830470995798629], 'group': [0.04200000000000001], 'causal': [0.07984031936127745]}],
                         [{'disp_imp': [0.7137094136205712], 'stat_par_diff': [-0.06571491279514055], 'acc': [0.9730964841158694], 'group': [0.06], 'causal': [0.2215568862275449]},
                          {'disp_imp': [0.6265808120521608], 'stat_par_diff': [-0.06703230545505082],'acc': [0.9107392938748434], 'group': [0.072], 'causal': [0.15169660678642716]}],
                         [{'disp_imp': [0.627876156298822], 'stat_par_diff': [-0.09709386740311857], 'acc': [0.9799513525466205], 'group': [0.10200000000000001], 'causal': [0.26147704590818366]},
                          {'disp_imp': [0.3612057808300871], 'stat_par_diff': [-0.19896184376499687],'acc': [0.9390432667502027], 'group': [0.21000000000000002],'causal': [0.26147704590818366]}],
                         [{'disp_imp': [0.627876156298822], 'stat_par_diff': [-0.09709386740311857], 'acc': [1.0], 'group': [0.10200000000000001], 'causal': [0.26147704590818366]},
                          {'disp_imp': [0.36108418385231245], 'stat_par_diff': [-0.1990214062724895], 'acc': [1.0], 'group': [0.21200000000000002], 'causal': [0.26147704590818366]}]],
                         
                        [[{'disp_imp': [1.0742594910304548], 'stat_par_diff': [0.01838463127453005], 'acc': [0.74], 'group': [0.027999999999999997], 'causal': [0.003992015968063872]},
                          {'disp_imp': [0.0], 'stat_par_diff': [-0.004048582995951417], 'acc': [0.71], 'group': [0.0],'causal': [0.0]}],
                         [{'disp_imp': [2.556737588652482], 'stat_par_diff': [0.09068374302829993], 'acc': [0.7333333333333333], 'group': [0.082], 'causal': [0.03792415169660679]},
                          {'disp_imp': ["inf"], 'stat_par_diff': [0.2830188679245283], 'acc': [0.7366666666666667],'group': [0.128], 'causal': [0.10179640718562874]}],
                         [{'disp_imp': [1.194078947368421], 'stat_par_diff': [0.06095041322314049], 'group': [0.033999999999999975], 'acc': [0.7085714285714285]},
                          {'disp_imp': [1.17086000897117], 'stat_par_diff': [0.054323164486393294],'group': [0.10999999999999999], 'acc': [0.7114285714285714]}],
                         [{'disp_imp': [1.4106138420151626], 'stat_par_diff': [0.17341458376368518], 'acc': [0.69], 'group': [0.1459999999999999], 'causal': [0.1536926147704591]},
                          {'disp_imp': [1.583623374244367], 'stat_par_diff': [0.24337330990757006],'acc': [0.6933333333333334], 'group': [0.050000000000000044],'causal': [0.06187624750499002]}],
                         [{'disp_imp': [0.7304964539007092], 'stat_par_diff': [-0.00392480892377608], 'acc': [0.72], 'group': [0.00841248303934871], 'causal': [0.0]},
                          {'disp_imp': ["nan"], 'stat_par_diff': [0.0], 'acc': [0.7133333333333334], 'group': [0.02],'causal': [0.0196078431372549]}],
                         [{'disp_imp': [1.3191489361702127], 'stat_par_diff': [0.15957446808510634], 'acc': [0.6366666666666667], 'group': [0.08399999999999996], 'causal': [0.2055888223552894]},
                          {'disp_imp': [2.402256370355962], 'stat_par_diff': [0.5506836758078069],'acc': [0.6833333333333333], 'group': [0.36], 'causal': [0.3532934131736527]}],
                         [{'disp_imp': [1.0719241443108234], 'stat_par_diff': [0.032121462507746334], 'acc': [0.7066666666666667], 'group': [0.05799999999999994], 'causal': [0.09780439121756487]},
                          {'disp_imp': [1.9460916442048517], 'stat_par_diff': [0.3485600794438927],'acc': [0.6666666666666666], 'group': [0.21599999999999997],'causal': [0.13572854291417166]}],
                         [{'disp_imp': [1.0750702529104779], 'stat_par_diff': [0.019314191282792825], 'acc': [0.9766666666666667], 'group': [0.025911355887752396], 'causal': [0.26013513513513514]},
                          {'disp_imp': [1.4515929477265697], 'stat_par_diff': [0.11152700328469939], 'acc': [0.98],'group': [0.12148217636022512], 'causal': [0.26174496644295303]}],
                         [{'disp_imp': [1.3435948361469712], 'stat_par_diff': [0.08883183568677794], 'acc': [0.9633333333333334], 'group': [0.09616186900292034], 'causal': [0.2866666666666667]},
                          {'disp_imp': [1.909990720692855], 'stat_par_diff': [0.22473455045451074],'acc': [0.9033333333333333], 'group': [0.23686679174484054], 'causal': [0.2866666666666667]}],
                         [{'disp_imp': [1.3645122440786832], 'stat_par_diff': [0.0937822763891758], 'acc': [1.0], 'group': [0.10118017309205352], 'causal': [0.2866666666666667]},
                          {'disp_imp': [1.909990720692855], 'stat_par_diff': [0.22473455045451074], 'acc': [1.0],'group': [0.23686679174484054], 'causal': [0.2866666666666667]}]],
                         
                         [[{'disp_imp': [0.8104798676227248], 'stat_par_diff': [-0.12481836675385061], 'acc': [0.9773218142548596], 'group': [0.04999999999999999], 'causal': [0.021956087824351298]},
                          {'disp_imp': [0.8974752356712752], 'stat_par_diff': [-0.06124416615016237],'acc': [0.9724622030237581], 'group': [0.14], 'causal': [0.015968063872255488]}],
                         [{'disp_imp': [0.6938754578754579], 'stat_par_diff': [-0.22635969664138678], 'acc': [0.6704545454545454], 'group': [0.21200000000000002], 'causal': [0.11776447105788423]},
                          {'disp_imp': [0.6158226448474127], 'stat_par_diff': [-0.27719125624933516],'acc': [0.6717171717171717], 'group': [0.242], 'causal': [0.07984031936127745]}],
                         [{'disp_imp': [0.806253554165482], 'stat_par_diff': [-0.12353447106758808], 'group': [0.15199999999999997], 'acc': [0.9856481481481482]},
                          {'disp_imp': [0.821595866659209], 'stat_par_diff': [-0.10868708724569232],'group': [0.09400000000000003], 'acc': [0.9863425925925926]}],
                         [{'disp_imp': [1.4376535626535625], 'stat_par_diff': [0.15529642545771571], 'acc': [0.9697624190064795], 'group': [0.06], 'causal': [0.005988023952095809]},
                          {'disp_imp': [1.2120612732397216], 'stat_par_diff': [0.08888376799156644],'acc': [0.9697624190064795], 'group': [0.13400000000000006],'causal': [0.007984031936127744]}],
                         [{'disp_imp': [1.394033264033264], 'stat_par_diff': [0.1376997965707643], 'acc': [0.9816414686825053], 'group': [0.05199999999999999], 'causal': [0.007984031936127744]},
                          {'disp_imp': [1.2319687462690527], 'stat_par_diff': [0.09263438382361511],'acc': [0.978401727861771], 'group': [0.13600000000000007], 'causal': [0.0]}],
                         [{'disp_imp': [1.4357493857493857], 'stat_par_diff': [0.1546207497820401], 'acc': [0.9703023758099352], 'group': [0.045999999999999985], 'causal': [0.01996007984031936]},
                          {'disp_imp': [1.2120612732397216], 'stat_par_diff': [0.08888376799156644], 'acc': [0.9697624190064795], 'group': [0.134], 'causal': [0.00998003992015968]}],
                         [{'disp_imp': [1.3240197944423295], 'stat_par_diff': [0.12368497529787847], 'acc': [0.9643628509719222], 'group': [0.19], 'causal': [0.26147704590818366]},
                          {'disp_imp': [1.1603619772247569], 'stat_par_diff': [0.06721442609750539], 'acc': [0.9465442764578834], 'group': [0.08599999999999997], 'causal': [0.06986027944111776]}],
                         [{'disp_imp': [1.4954349307290484], 'stat_par_diff': [0.1584859052600988], 'acc': [0.9978401727861771], 'group': [0.0], 'causal': [0.5508982035928144]},
                          {'disp_imp': [1.2548414667194763], 'stat_par_diff': [0.0971425392940578], 'acc': [0.9978401727861771], 'group': [0.126], 'causal': [0.5489021956087824]}],
                         [{'disp_imp': [1.4379321250190844], 'stat_par_diff': [0.14558601475165273], 'acc': [0.9983801295896328], 'group': [0.0], 'causal': [0.5469061876247505]},
                          {'disp_imp': [1.2334824630306342], 'stat_par_diff': [0.09054187922805124],'acc': [0.9983801295896328], 'group': [0.118], 'causal': [0.5469061876247505]}],
                         [{'disp_imp': [1.4468029004614371], 'stat_par_diff': [0.1477332170880558], 'acc': [1.0], 'group': [0.0], 'causal': [0.5469061876247505]},
                          {'disp_imp': [1.2334824630306342], 'stat_par_diff': [0.09054187922805124], 'acc': [1.0],'group': [0.118], 'causal': [0.5469061876247505]}]]
                         ]

all_multi_orig_metrics = [[{'disp_imp': [0.5101726154022098], 'stat_par_diff': [-0.11955292188481477], 'group': [0.22999999999999998], 'causal': [0.126], 'acc': [0.8356305741873664]},
                          {'disp_imp': [0.12954426763297364], 'stat_par_diff': [-0.13900596470877594], 'acc': [0.8016788370982052], 'group': [0.252], 'causal': [0.204]},
                          {'disp_imp': [0.49074072810204933], 'stat_par_diff': [-0.11029352471431203], 'group': [0.166], 'acc': [0.8462486179118622]},
                          {'disp_imp': [0.4235316765164495], 'stat_par_diff': [-0.12330508928211137],'acc': [0.8495614358369573], 'group': [0.266], 'causal': [0.088]},
                          {'disp_imp': [0.4235316765164495], 'stat_par_diff': [-0.12330508928211137], 'acc': [0.8495614358369573], 'group': [0.266], 'causal': [0.088]},
                          {'disp_imp': [0.4235316765164495], 'stat_par_diff': [-0.12330508928211137], 'acc': [0.8495614358369573], 'group': [0.266], 'causal': [0.088]},
                          {'disp_imp': [0.4354775536043105], 'stat_par_diff': [-0.11363388092184563],'acc': [0.8480872705830323], 'group': [0.21800000000000003], 'causal': [0.03]},
                          {'disp_imp': [0.4354775536043105], 'stat_par_diff': [-0.11363388092184563],'acc': [0.8480872705830323], 'group': [0.22000000000000003], 'causal': [0.036]},
                          {'disp_imp': [0.42270753953329554], 'stat_par_diff': [-0.13148605555890985],'acc': [0.8492666027861723], 'group': [0.244], 'causal': [0.03]},
                          {'disp_imp': [0.42270753953329554], 'stat_par_diff': [-0.13148605555890985],'acc': [0.8492666027861723], 'group': [0.244], 'causal': [0.03]}],
                          
                          [{'disp_imp': [1.8881118881118881], 'stat_par_diff': [0.14472934472934473], 'group': [0.18], 'causal': [0.088], 'acc': [0.8033333333333333]},
                          {'disp_imp': ["inf"], 'stat_par_diff': [0.11965811965811966], 'acc': [0.74], 'group': [0.2],'causal': [0.172]},
                          {'disp_imp': [1.1117479642659498], 'stat_par_diff': [0.032541007194244576],'group': [0.11200000000000002], 'acc': [0.7128571428571429]},
                          {'disp_imp': [1.5865384615384615], 'stat_par_diff': [0.13903133903133902],'acc': [0.7766666666666666], 'group': [0.28600000000000003], 'causal': [0.182]},
                          {'disp_imp': [1.5865384615384615], 'stat_par_diff': [0.13903133903133902],'acc': [0.7766666666666666], 'group': [0.31122967479674796],'causal': [0.20161290322580644]},
                          {'disp_imp': [1.5865384615384615], 'stat_par_diff': [0.13903133903133902],'acc': [0.7766666666666666], 'group': [0.28600000000000003], 'causal': [0.182]},
                          {'disp_imp': [1.5865384615384615], 'stat_par_diff': [0.13903133903133902],'acc': [0.7766666666666666], 'group': [0.28600000000000003], 'causal': [0.182]},
                          {'disp_imp': [1.4574898785425099], 'stat_par_diff': [0.12877492877492874], 'acc': [0.76],'group': [0.05982905982905981], 'causal': [0.10738255033557047]},
                          {'disp_imp': [1.4574898785425099], 'stat_par_diff': [0.12877492877492874], 'acc': [0.76],'group': [0.05982905982905981], 'causal': [0.10738255033557047]},
                          {'disp_imp': [1.4574898785425099], 'stat_par_diff': [0.12877492877492874], 'acc': [0.76],'group': [0.05982905982905981], 'causal': [0.10738255033557047]}],
                          
                          [{'disp_imp': [0.8736797634136036], 'stat_par_diff': [-0.07947900053163215], 'group': [0.16400000000000003], 'causal': [0.012], 'acc': [0.9789416846652268]},
                          {'disp_imp': [0.7609608507662643], 'stat_par_diff': [-0.18520972249789447],'acc': [0.6616161616161617], 'group': [0.432], 'causal': [0.234]},
                          {'disp_imp': [0.8617067047623822], 'stat_par_diff': [-0.08488103784227252],'group': [0.21800000000000003], 'acc': [0.9879629629629629]},
                          {'disp_imp': [1.2113234253361642], 'stat_par_diff': [0.0793726741095162],'acc': [0.9838012958963283], 'group': [0.15000000000000002], 'causal': [0.0]},
                          {'disp_imp': [1.208209483368719], 'stat_par_diff': [0.07820308346624133], 'acc': [0.9838012958963283], 'group': [0.15800000000000003], 'causal': [0.008]},
                          {'disp_imp': [1.208209483368719], 'stat_par_diff': [0.07820308346624133],'acc': [0.9838012958963283], 'group': [0.15800000000000003], 'causal': [0.008]},
                          {'disp_imp': [0.8747552149851], 'stat_par_diff': [-0.07820308346624139],'acc': [0.9838012958963283], 'group': [0.15800000000000003], 'causal': [0.008]},
                          {'disp_imp': [0.8762751322751323], 'stat_par_diff': [-0.07769803296119082],'acc': [0.9800215982721382], 'group': [0.0], 'causal': [0.024]},
                          {'disp_imp': [0.8762751322751323], 'stat_par_diff': [-0.07769803296119082],'acc': [0.9800215982721382], 'group': [0.0], 'causal': [0.024]},
                          {'disp_imp': [0.8762751322751323], 'stat_par_diff': [-0.07769803296119082],'acc': [0.9800215982721382], 'group': [0.0], 'causal': [0.024]}]
                          ]

all_multi_trans_metrics = [[{'disp_imp': [0.5868815745338717], 'stat_par_diff': [-0.09939838268128542], 'group': [0.24], 'causal': [0.144], 'acc': [0.8264170413503353]},
                           {'disp_imp': [0.21745539399048172], 'stat_par_diff': [-0.13028124875514435], 'group': [0.208], 'causal': [0.172], 'acc': [0.8017470825087013]},
                           {'disp_imp': [0.4850352961124847], 'stat_par_diff': [-0.12300095797669965], 'group': [0.17400000000000002], 'acc': [0.8429631969673037]},
                           {'disp_imp': [0.7899930362027393], 'stat_par_diff': [-0.12026633733887088], 'acc': [0.6355126409670524], 'group': [0.29], 'causal': [0.492]},
                           {'disp_imp': [0.5544277624086987], 'stat_par_diff': [-0.09211231004802446], 'acc': [0.8508144763027935], 'group': [0.09200000000000001], 'causal': [0.11]},
                           {'disp_imp': [0.4001938017367525], 'stat_par_diff': [-0.08685447037011337], 'acc': [0.830176162747844], 'group': [0.084], 'causal': [0.03]},
                           {'disp_imp': [0.5869709101579331], 'stat_par_diff': [-0.07884420426119343],'acc': [0.8303235792732365], 'group': [0.15799999999999997], 'causal': [0.07]},
                           {'disp_imp': [0.6327423752891234], 'stat_par_diff': [-0.07919200495026152],'acc': [0.959607872042456], 'group': [0.172], 'causal': [0.212]},
                           {'disp_imp': [0.5271890049212574], 'stat_par_diff': [-0.12236540761314657], 'acc': [0.9586496646274048], 'group': [0.246], 'causal': [0.26]},
                           {'disp_imp': [0.5271890049212574], 'stat_par_diff': [-0.12236540761314657], 'acc': [1.0],'group': [0.246], 'causal': [0.26]}],
                           
                           [{'disp_imp': ["nan"], 'stat_par_diff': [0.0], 'group': [0.0], 'causal': [0.0], 'acc': [0.7133333333333334]},
                           {'disp_imp': [2.307692307692308], 'stat_par_diff': [0.009686609686609688], 'group': [0.138],'causal': [0.1], 'acc': [0.7066666666666667]},
                           {'disp_imp': [1.052113973845554], 'stat_par_diff': [0.01692661870503598],'group': [0.11599999999999999], 'acc': [0.7028571428571428]},
                           {'disp_imp': [1.307692307692308], 'stat_par_diff': [0.13675213675213682], 'acc': [0.69],'group': [0.20199999999999996], 'causal': [0.098]},
                           {'disp_imp': [0.8653846153846153], 'stat_par_diff': [-0.003988603988603991], 'acc': [0.72], 'group': [0.12583333333333335], 'causal': [0.03636363636363636]},
                           {'disp_imp': [1.3432835820895521], 'stat_par_diff': [0.17037037037037034],'acc': [0.6466666666666666], 'group': [0.20400000000000007], 'causal': [0.266]},
                           {'disp_imp': [1.342657342657343], 'stat_par_diff': [0.13960113960113968], 'acc': [0.68],'group': [0.196], 'causal': [0.09]},
                           {'disp_imp': [1.2587412587412588], 'stat_par_diff': [0.06324786324786327], 'acc': [0.98],'group': [0.014041514041514047], 'causal': [0.26174496644295303]},
                           {'disp_imp': [1.3846153846153848], 'stat_par_diff': [0.09971509971509973],'acc': [0.9533333333333334], 'group': [0.03357753357753357],'causal': [0.2866666666666667]},
                           {'disp_imp': [1.3846153846153848], 'stat_par_diff': [0.09971509971509973], 'acc': [1.0], 'group': [0.03357753357753357], 'causal': [0.2866666666666667]}],
                           
                           [{'disp_imp': [0.8796224796224796], 'stat_par_diff': [-0.07458798511430087], 'group': [0.16000000000000003], 'causal': [0.016], 'acc': [0.9757019438444925]},
                           {'disp_imp': [0.7582321602376928], 'stat_par_diff': [-0.16780801217435204], 'group': [0.376],'causal': [0.116], 'acc': [0.6704545454545454]},
                           {'disp_imp': [0.8633441521823582], 'stat_par_diff': [-0.08387601271664447],'group': [0.21200000000000002], 'acc': [0.987037037037037]},
                           {'disp_imp': [1.2156940323112428], 'stat_par_diff': [0.08694843168527377],'acc': [0.9697624190064795], 'group': [0.13999999999999996], 'causal': [0.01]},
                           {'disp_imp': [1.2207317073170731], 'stat_par_diff': [0.08660287081339713], 'acc': [0.9740820734341252], 'group': [0.15199999999999997], 'causal': [0.008]},
                           {'disp_imp': [1.217857142857143], 'stat_par_diff': [0.08755980861244023],'acc': [0.9703023758099352], 'group': [0.15000000000000002], 'causal': [0.02]},
                           {'disp_imp': [1.195384108143752], 'stat_par_diff': [0.07876129718234981],'acc': [0.9254859611231101], 'group': [0.13199999999999995], 'causal': [0.05]},
                           {'disp_imp': [1.23005698005698], 'stat_par_diff': [0.08585858585858586], 'acc': [1.0],   'group': [0.0], 'causal': [0.546]},
                           {'disp_imp': [1.23005698005698], 'stat_par_diff': [0.08585858585858586], 'acc': [1.0], 'group': [0.0], 'causal': [0.546]},
                           {'disp_imp': [1.23005698005698], 'stat_par_diff': [0.08585858585858586], 'acc': [1.0], 'group': [0.0], 'causal': [0.546]}]
                           ]


# dataset_name = ["Adult income", "German credit", "COMPAS"]
# sens_attrs = [["race", "sex"], ["sex", "age"], ["sex", "race"]]
Plot = Plot(dataset_name=dataset_name, sens_attr=sens_attrs, processing_name=processing_names)
Plot.plot_abs_acc_all_methods(all_uni_orig_metrics, all_uni_trans_metrics, all_multi_orig_metrics, all_multi_trans_metrics)

# multi_metric_names = ["stat_par_diff", "avg_odds_diff", "eq_opp_diff"]
# # 2 images: one for group metric. one for causal metric
# Plot.plot_abs_acc_multi_metric(all_uni_orig_metrics, all_uni_trans_metrics, all_multi_orig_metrics, all_multi_trans_metrics)
# # 3 images: one for 'race', one for 'sex', one for 'race,sex'
# Plot.plot_abs_acc_individual_metric(all_uni_orig_metrics, all_uni_trans_metrics, all_multi_orig_metrics, all_multi_trans_metrics)
